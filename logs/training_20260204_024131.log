2026-02-04 02:41:31,024 - training - INFO - Starting training with config: {'model': {'vision_encoder': 'microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', 'text_encoder': 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'type': 'generative', 'text_decoder': 'microsoft/BioGPT', 'freeze_vision': True, 'freeze_text': False, 'fusion_method': 'btia', 'use_answer_distillation': False, 'use_embedding_matching': False, 'pretraining_epochs': 10}, 'training': {'batch_size': 16, 'learning_rate': 1e-05, 'weight_decay': 0.01, 'epochs': 50, 'warmup_ratio': 0.1, 'fp16': True, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'save_every_epoch': True, 'checkpoint_dir': 'checkpoints', 'resume_from': None, 'early_stopping_patience': 10, 'early_stopping_metric': 'val_accuracy'}, 'data': {'image_size': 224, 'max_question_length': 64, 'max_answer_length': 32, 'use_slake_augmentation': True, 'use_pathvqa_augmentation': True, 'train_split': 0.8, 'num_workers': 4, 'vqa_rad_dir': 'data/vqa_rad', 'slake_dir': 'data/slake', 'pathvqa_dir': 'data/pathvqa'}, 'logging': {'log_dir': 'logs', 'log_every_n_steps': 10, 'use_tensorboard': True}}
2026-02-04 02:41:31,026 - training - INFO - Creating data loaders...
2026-02-04 02:41:39,646 - training - INFO - Creating model...
2026-02-04 02:41:44,825 - training - INFO - Model parameters: {'total': 416820288, 'trainable': 393312256, 'frozen': 23508032}
2026-02-04 02:41:44,825 - training - INFO - 
*** Two-Stage Training Enabled ***
2026-02-04 02:41:44,825 - training - INFO - Stage 1: 10 epochs training projection only (LLM frozen)
2026-02-04 02:41:44,826 - training - INFO - Stage 2: Remaining epochs training projection + LLM
2026-02-04 02:41:44,827 - training - INFO - After freezing LLM - Parameters: {'total': 416820288, 'trainable': 3147776, 'frozen': 413672512}
2026-02-04 02:41:44,828 - training - INFO - Starting training...
2026-02-04 02:41:44,828 - training - INFO - 
==================================================
2026-02-04 02:41:44,828 - training - INFO - Epoch 1/50 [Stage 1/Projection]
2026-02-04 02:41:44,828 - training - INFO - ==================================================
2026-02-04 02:47:30,952 - training - INFO - Train - Loss: 6.7740, Acc: 0.0429
2026-02-04 02:47:52,511 - training - INFO - 
--- Generative Debug (Batch 0) ---
2026-02-04 02:47:52,836 - training - INFO - Sample 1 [Closed]:
2026-02-04 02:47:52,837 - training - INFO -   GT: Question: is there evidence of an aortic aneurysm? The answer is yes
2026-02-04 02:47:52,837 - training - INFO -   Pred: [FULL] "
2026-02-04 02:47:52,939 - training - INFO - Sample 2 [Closed]:
2026-02-04 02:47:52,940 - training - INFO -   GT: Question: is there airspace consolidation on the left side? The answer is yes
2026-02-04 02:47:52,940 - training - INFO -   Pred: [FULL] the left side of the answer.
2026-02-04 02:47:53,125 - training - INFO - Sample 3 [Closed]:
2026-02-04 02:47:53,125 - training - INFO -   GT: Question: is there any intraparenchymal abnormalities in the lung fields? The answer is no
2026-02-04 02:47:53,126 - training - INFO -   Pred: [FULL] : "The answer is that of a patient with an abnormal lung.
2026-02-04 02:47:53,182 - training - INFO - Sample 4 [Open]:
2026-02-04 02:47:53,182 - training - INFO -   GT: Question: which side of the heart border is obscured? The answer is right
2026-02-04 02:47:53,182 - training - INFO -   Pred: [FULL] obscured.
2026-02-04 02:47:53,334 - training - INFO - Sample 5 [Open]:
2026-02-04 02:47:53,335 - training - INFO -   GT: Question: where are the kidney? The answer is not seen here
2026-02-04 02:47:53,335 - training - INFO -   Pred: [FULL] the same as in the case of a single question.
2026-02-04 02:47:53,437 - training - INFO - Sample 6 [Closed]:
2026-02-04 02:47:53,437 - training - INFO -   GT: Question: are the kidneys present in this image? The answer is no
2026-02-04 02:47:53,438 - training - INFO -   Pred: [FULL] the same as in this article.
2026-02-04 02:47:53,564 - training - INFO - Sample 7 [Open]:
2026-02-04 02:47:53,564 - training - INFO -   GT: Question: is the colon more prominent on the patient's right or left side? The answer is left
2026-02-04 02:47:53,564 - training - INFO -   Pred: [FULL] the right or left side of the answer.
2026-02-04 02:47:53,685 - training - INFO - Sample 8 [Open]:
2026-02-04 02:47:53,685 - training - INFO -   GT: Question: where is the colon most prominent from this view? The answer is left
2026-02-04 02:47:53,685 - training - INFO -   Pred: [FULL] the same as from a different perspective.
2026-02-04 02:47:53,850 - training - INFO - Sample 9 [Open]:
2026-02-04 02:47:53,850 - training - INFO -   GT: Question: is the heart size in this image smaller or larger than if the image was taken ap? The answer is smaller
2026-02-04 02:47:53,851 - training - INFO -   Pred: [FULL] the same as if it were taken at a different time.
2026-02-04 02:47:53,955 - training - INFO - Sample 10 [Closed]:
2026-02-04 02:47:53,956 - training - INFO -   GT: Question: is the liver visible in the image? The answer is no
2026-02-04 02:47:53,956 - training - INFO -   Pred: [FULL] the same as in the title.
2026-02-04 02:47:54,096 - training - INFO - Sample 11 [Closed]:
2026-02-04 02:47:54,096 - training - INFO -   GT: Question: is this an axial image? The answer is yes
2026-02-04 02:47:54,097 - training - INFO -   Pred: [FULL] the one that is most likely to be true.
2026-02-04 02:47:54,201 - training - INFO - Sample 12 [Open]:
2026-02-04 02:47:54,201 - training - INFO -   GT: Question: what structures are visible in this image? The answer is skull cartilage and medulla
2026-02-04 02:47:54,202 - training - INFO -   Pred: [FULL] the same as in this article.
2026-02-04 02:47:54,363 - training - INFO - Sample 13 [Open]:
2026-02-04 02:47:54,364 - training - INFO -   GT: Question: what is this lucency amid densities in the right lung? The answer is the right bronchus
2026-02-04 02:47:54,364 - training - INFO -   Pred: [FULL] the same as in the case of the other two cases.
2026-02-04 02:47:54,396 - training - INFO - Sample 14 [Closed]:
2026-02-04 02:47:54,396 - training - INFO -   GT: Question: is there evidence of any abnormalities of the lung parenchyma? The answer is no
2026-02-04 02:47:54,396 - training - INFO -   Pred: [FULL] "
2026-02-04 02:47:54,463 - training - INFO - Sample 15 [Closed]:
2026-02-04 02:47:54,464 - training - INFO -   GT: Question: are the temporal bones fractured? The answer is no
2026-02-04 02:47:54,464 - training - INFO -   Pred: [FULL] the temporal bone.
2026-02-04 02:47:54,676 - training - INFO - Sample 16 [Closed]:
2026-02-04 02:47:54,677 - training - INFO -   GT: Question: is there consolidation in the lungs? The answer is no
2026-02-04 02:47:54,677 - training - INFO -   Pred: [FULL] : "It is not possible to prove that the patient has a disease.
2026-02-04 02:47:54,677 - training - INFO - ----------------------------------

2026-02-04 02:48:36,983 - training - INFO - Val - Loss: 6.1984, Overall: 0.0355, Closed: 0.0398, Open: 0.0300
2026-02-04 02:48:40,376 - training - INFO - New best model saved! Accuracy: 0.0355
2026-02-04 02:48:40,377 - training - INFO - 
==================================================
2026-02-04 02:48:40,377 - training - INFO - Epoch 2/50 [Stage 1/Projection]
2026-02-04 02:48:40,377 - training - INFO - ==================================================

2026-02-03 14:05:03,112 - training - INFO - Starting training with config: {'model': {'vision_encoder': 'microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', 'text_encoder': 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'hidden_dim': 768, 'num_heads': 8, 'num_attention_layers': 2, 'dropout': 0.3, 'top_k_answers': 5, 'fusion_method': 'btia', 'use_answer_distillation': True, 'use_embedding_matching': True}, 'training': {'batch_size': 16, 'learning_rate': 2e-05, 'weight_decay': 0.01, 'epochs': 50, 'warmup_ratio': 0.1, 'fp16': True, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'save_every_epoch': True, 'checkpoint_dir': 'checkpoints', 'resume_from': None, 'early_stopping_patience': 10, 'early_stopping_metric': 'val_accuracy'}, 'data': {'image_size': 224, 'max_question_length': 64, 'max_answer_length': 32, 'use_slake_augmentation': False, 'use_pathvqa_augmentation': True, 'train_split': 0.8, 'num_workers': 4, 'vqa_rad_dir': 'data/vqa_rad', 'slake_dir': 'data/slake', 'pathvqa_dir': 'data/pathvqa'}, 'logging': {'log_dir': 'logs', 'log_every_n_steps': 10, 'use_tensorboard': True}}
2026-02-03 14:05:03,117 - training - INFO - Creating data loaders...
2026-02-03 14:05:13,685 - training - INFO - Number of answers: 3704
2026-02-03 14:05:13,686 - training - INFO - Creating model...
2026-02-03 14:05:22,029 - training - INFO - Building answer embedding cache...
2026-02-03 14:05:25,680 - training - INFO - Setting class weights for balanced training...
2026-02-03 14:05:25,692 - training - INFO - Class weights min: 0.0201, max: 1.0865
2026-02-03 14:05:25,697 - training - INFO - Model parameters: {'total': 256956786, 'trainable': 256956786, 'frozen': 0}
2026-02-03 14:05:25,702 - training - INFO - Starting training...
2026-02-03 14:05:25,703 - training - INFO - 
==================================================
2026-02-03 14:05:25,704 - training - INFO - Epoch 1/50
2026-02-03 14:05:25,705 - training - INFO - ==================================================
2026-02-03 14:14:31,684 - training - INFO - Train - Loss: 4.7538, Acc: 0.0264
2026-02-03 14:15:39,841 - training - INFO - Val - Loss: 4.8547, Overall: 0.0976, Closed: 0.1753, Open: 0.0000
2026-02-03 14:15:49,157 - training - INFO - New best model saved! Accuracy: 0.0976
2026-02-03 14:15:49,159 - training - INFO - 
==================================================
2026-02-03 14:15:49,160 - training - INFO - Epoch 2/50
2026-02-03 14:15:49,160 - training - INFO - ==================================================
2026-02-03 14:24:43,637 - training - INFO - Train - Loss: 4.5944, Acc: 0.1373
2026-02-03 14:26:24,826 - training - INFO - Val - Loss: 4.7505, Overall: 0.2594, Closed: 0.4661, Open: 0.0000
2026-02-03 14:26:42,241 - training - INFO - New best model saved! Accuracy: 0.2594
2026-02-03 14:26:42,242 - training - INFO - 
==================================================
2026-02-03 14:26:42,243 - training - INFO - Epoch 3/50
2026-02-03 14:26:42,244 - training - INFO - ==================================================
2026-02-03 14:51:33,834 - training - INFO - Train - Loss: 4.5198, Acc: 0.2168
2026-02-03 14:53:21,713 - training - INFO - Val - Loss: 4.7012, Overall: 0.2616, Closed: 0.4701, Open: 0.0000
2026-02-03 14:53:38,797 - training - INFO - New best model saved! Accuracy: 0.2616
2026-02-03 14:53:38,798 - training - INFO - 
==================================================
2026-02-03 14:53:38,799 - training - INFO - Epoch 4/50
2026-02-03 14:53:38,800 - training - INFO - ==================================================

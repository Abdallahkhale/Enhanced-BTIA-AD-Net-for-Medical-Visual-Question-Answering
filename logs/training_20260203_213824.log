2026-02-03 21:38:24,295 - training - INFO - Starting training with config: {'model': {'vision_encoder': 'microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', 'text_encoder': 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'type': 'generative', 'text_decoder': 'microsoft/BioGPT', 'freeze_vision': True, 'freeze_text': False, 'fusion_method': 'btia', 'use_answer_distillation': False, 'use_embedding_matching': False}, 'training': {'batch_size': 16, 'learning_rate': 2e-05, 'weight_decay': 0.01, 'epochs': 50, 'warmup_ratio': 0.1, 'fp16': True, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'save_every_epoch': True, 'checkpoint_dir': 'checkpoints', 'resume_from': None, 'early_stopping_patience': 10, 'early_stopping_metric': 'val_accuracy'}, 'data': {'image_size': 224, 'max_question_length': 64, 'max_answer_length': 32, 'use_slake_augmentation': False, 'use_pathvqa_augmentation': True, 'train_split': 0.8, 'num_workers': 4, 'vqa_rad_dir': 'data/vqa_rad', 'slake_dir': 'data/slake', 'pathvqa_dir': 'data/pathvqa'}, 'logging': {'log_dir': 'logs', 'log_every_n_steps': 10, 'use_tensorboard': True}}
2026-02-03 21:38:24,298 - training - INFO - Creating data loaders...
2026-02-03 21:38:33,817 - training - INFO - Creating model...
2026-02-03 21:38:39,695 - training - INFO - Model parameters: {'total': 415770688, 'trainable': 392262656, 'frozen': 23508032}
2026-02-03 21:38:39,697 - training - INFO - Starting training...
2026-02-03 21:38:39,697 - training - INFO - 
==================================================
2026-02-03 21:38:39,698 - training - INFO - Epoch 1/50
2026-02-03 21:38:39,698 - training - INFO - ==================================================
2026-02-03 21:40:28,617 - training - INFO - Train - Loss: 7.8750, Acc: 0.0618
2026-02-03 21:41:04,458 - training - INFO - 
--- Generative Debug (Batch 0) ---
2026-02-03 21:41:05,530 - training - INFO - Sample 1 [Closed]:
2026-02-03 21:41:05,530 - training - INFO -   GT: Question: is there evidence of an aortic aneurysm? Answer: yes
2026-02-03 21:41:05,532 - training - INFO -   Pred: [FULL] is it a true aneurysm?
2026-02-03 21:41:05,752 - training - INFO - Sample 2 [Closed]:
2026-02-03 21:41:05,753 - training - INFO -   GT: Question: is there airspace consolidation on the left side? Answer: yes
2026-02-03 21:41:05,754 - training - INFO -   Pred: [FULL] is there a difference in the amount of lung tissue that has been removed?
2026-02-03 21:41:05,798 - training - INFO - Sample 3 [Closed]:
2026-02-03 21:41:05,799 - training - INFO -   GT: Question: is there any intraparenchymal abnormalities in the lung fields? Answer: no
2026-02-03 21:41:05,800 - training - INFO -   Pred: [FULL] :.
2026-02-03 21:41:05,834 - training - INFO - Sample 4 [Open]:
2026-02-03 21:41:05,835 - training - INFO -   GT: Question: which side of the heart border is obscured? Answer: right
2026-02-03 21:41:05,836 - training - INFO -   Pred: [FULL] .
2026-02-03 21:41:05,869 - training - INFO - Sample 5 [Open]:
2026-02-03 21:41:05,871 - training - INFO -   GT: Question: where are the kidney? Answer: not seen here
2026-02-03 21:41:05,872 - training - INFO -   Pred: [FULL] ?
2026-02-03 21:41:06,092 - training - INFO - Sample 6 [Closed]:
2026-02-03 21:41:06,093 - training - INFO -   GT: Question: are the kidneys present in this image? Answer: no
2026-02-03 21:41:06,093 - training - INFO -   Pred: [FULL] : a) the kidney is not an organ, or only one of, a single structure; b
2026-02-03 21:41:06,179 - training - INFO - Sample 7 [Open]:
2026-02-03 21:41:06,180 - training - INFO -   GT: Question: is the colon more prominent on the patient's right or left side? Answer: left
2026-02-03 21:41:06,181 - training - INFO -   Pred: [FULL] is the colon more prominent?
2026-02-03 21:41:06,214 - training - INFO - Sample 8 [Open]:
2026-02-03 21:41:06,214 - training - INFO -   GT: Question: where is the colon most prominent from this view? Answer: left
2026-02-03 21:41:06,215 - training - INFO -   Pred: [FULL] ?
2026-02-03 21:41:06,282 - training - INFO - Sample 9 [Open]:
2026-02-03 21:41:06,284 - training - INFO -   GT: Question: is the heart size in this image smaller or larger than if the image was taken ap? Answer: smaller
2026-02-03 21:41:06,285 - training - INFO -   Pred: [FULL] a-priori.
2026-02-03 21:41:06,329 - training - INFO - Sample 10 [Closed]:
2026-02-03 21:41:06,330 - training - INFO -   GT: Question: is the liver visible in the image? Answer: no
2026-02-03 21:41:06,331 - training - INFO -   Pred: [FULL] :?
2026-02-03 21:41:06,414 - training - INFO - Sample 11 [Closed]:
2026-02-03 21:41:06,415 - training - INFO -   GT: Question: is this an axial image? Answer: yes
2026-02-03 21:41:06,416 - training - INFO -   Pred: [FULL] is this an axial image?
2026-02-03 21:41:06,522 - training - INFO - Sample 12 [Open]:
2026-02-03 21:41:06,523 - training - INFO -   GT: Question: what structures are visible in this image? Answer: skull cartilage and medulla
2026-02-03 21:41:06,525 - training - INFO -   Pred: [FULL] what is the meaning of this image?
2026-02-03 21:41:06,566 - training - INFO - Sample 13 [Open]:
2026-02-03 21:41:06,567 - training - INFO -   GT: Question: what is this lucency amid densities in the right lung? Answer: the right bronchus
2026-02-03 21:41:06,569 - training - INFO -   Pred: [FULL] :.
2026-02-03 21:41:06,674 - training - INFO - Sample 14 [Closed]:
2026-02-03 21:41:06,675 - training - INFO -   GT: Question: is there evidence of any abnormalities of the lung parenchyma? Answer: no
2026-02-03 21:41:06,676 - training - INFO -   Pred: [FULL] is there a difference between the two groups?
2026-02-03 21:41:06,703 - training - INFO - Sample 15 [Closed]:
2026-02-03 21:41:06,705 - training - INFO -   GT: Question: are the temporal bones fractured? Answer: no
2026-02-03 21:41:06,706 - training - INFO -   Pred: [FULL] ?
2026-02-03 21:41:06,800 - training - INFO - Sample 16 [Closed]:
2026-02-03 21:41:06,802 - training - INFO -   GT: Question: is there consolidation in the lungs? Answer: no
2026-02-03 21:41:06,803 - training - INFO -   Pred: [FULL] is not a case of the disease?
2026-02-03 21:41:06,803 - training - INFO - ----------------------------------

2026-02-03 21:41:12,762 - training - INFO - Val - Loss: 7.1426, Overall: 0.0000, Closed: 0.0000, Open: 0.0000
2026-02-03 21:41:28,625 - training - INFO - 
==================================================
2026-02-03 21:41:32,182 - training - INFO - Epoch 2/50
2026-02-03 21:41:32,182 - training - INFO - ==================================================

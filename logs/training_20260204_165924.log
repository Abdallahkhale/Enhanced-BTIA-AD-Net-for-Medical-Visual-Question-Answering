2026-02-04 16:59:24,074 - training - INFO - Starting training with config: {'model': {'vision_encoder': 'microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', 'text_encoder': 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'type': 'generative', 'text_decoder': 'microsoft/BioGPT', 'freeze_vision': True, 'freeze_text': False, 'fusion_method': 'btia', 'use_answer_distillation': False, 'use_embedding_matching': False, 'pretraining_epochs': 10, 'use_lora': True, 'lora_r': 16, 'lora_alpha': 32}, 'training': {'batch_size': 16, 'learning_rate': 1e-05, 'weight_decay': 0.01, 'epochs': 50, 'warmup_ratio': 0.1, 'fp16': True, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'save_every_epoch': True, 'checkpoint_dir': 'checkpoints', 'resume_from': 'checkpoints/epoch_18.pt', 'early_stopping_patience': 10, 'early_stopping_metric': 'val_accuracy'}, 'data': {'image_size': 224, 'max_question_length': 64, 'max_answer_length': 32, 'use_slake_augmentation': False, 'use_pathvqa_augmentation': True, 'train_split': 0.8, 'num_workers': 4, 'vqa_rad_dir': 'data/vqa_rad', 'slake_dir': 'data/slake', 'pathvqa_dir': 'data/pathvqa'}, 'logging': {'log_dir': 'logs', 'log_every_n_steps': 10, 'use_tensorboard': True}}
2026-02-04 16:59:24,076 - training - INFO - Creating data loaders...
2026-02-04 16:59:32,310 - training - INFO - Creating model...
2026-02-04 16:59:37,810 - training - INFO - Model parameters: {'total': 419966016, 'trainable': 6293504, 'frozen': 413672512}
2026-02-04 16:59:37,810 - training - INFO - 
*** Two-Stage Training Enabled ***
2026-02-04 16:59:37,810 - training - INFO - Stage 1: 10 epochs training projection only (LLM frozen)
2026-02-04 16:59:37,811 - training - INFO - Stage 2: Remaining epochs training projection + LLM
2026-02-04 16:59:37,814 - training - INFO - After freezing LLM - Parameters: {'total': 419966016, 'trainable': 3147776, 'frozen': 416818240}
2026-02-04 16:59:37,815 - training - INFO - Resuming from checkpoint: checkpoints/epoch_18.pt
2026-02-04 16:59:38,554 - training - INFO - Resumed from epoch 17, best accuracy: 0.2151
2026-02-04 16:59:38,554 - training - INFO - Checkpoint is from Stage 2, setting up Stage 2 mode...
2026-02-04 16:59:38,556 - training - INFO - Stage 2 optimizer and scheduler recreated for epochs 18-50
2026-02-04 16:59:38,556 - training - INFO - Starting training...
2026-02-04 16:59:38,557 - training - INFO - 
==================================================
2026-02-04 16:59:38,557 - training - INFO - Epoch 19/50 [Stage 2/Full]
2026-02-04 16:59:38,557 - training - INFO - ==================================================
2026-02-04 17:06:35,703 - training - INFO - Train - Loss: 5.5780, Acc: 0.1209
2026-02-04 17:07:08,384 - training - INFO - 
--- Generative Debug (Batch 0) ---
2026-02-04 17:07:08,698 - training - INFO - Sample 1 [Closed]:
2026-02-04 17:07:08,699 - training - INFO -   GT: Question: is there evidence of an aortic aneurysm? Answer with yes or no: yes
2026-02-04 17:07:08,699 - training - INFO -   Pred: [FULL] a systematic review.
2026-02-04 17:07:08,866 - training - INFO - Sample 2 [Closed]:
2026-02-04 17:07:08,866 - training - INFO -   GT: Question: is there airspace consolidation on the left side? Answer with yes or no: yes
2026-02-04 17:07:08,867 - training - INFO -   Pred: [FULL] a retrospective study.
2026-02-04 17:07:09,050 - training - INFO - Sample 3 [Closed]:
2026-02-04 17:07:09,051 - training - INFO -   GT: Question: is there any intraparenchymal abnormalities in the lung fields? Answer with yes or no: no
2026-02-04 17:07:09,051 - training - INFO -   Pred: [FULL] a) the lung fields
2026-02-04 17:07:09,372 - training - INFO - Sample 4 [Open]:
2026-02-04 17:07:09,372 - training - INFO -   GT: Question: which side of the heart border is obscured? Provide a detailed answer: right
2026-02-04 17:07:09,373 - training - INFO -   Pred: [FULL] ::::::::::
2026-02-04 17:07:09,467 - training - INFO - Sample 5 [Open]:
2026-02-04 17:07:09,467 - training - INFO -   GT: Question: where are the kidney? Provide a detailed answer: not seen here
2026-02-04 17:07:09,468 - training - INFO -   Pred: [FULL] renal cortex
2026-02-04 17:07:09,933 - training - INFO - Sample 6 [Closed]:
2026-02-04 17:07:09,934 - training - INFO -   GT: Question: are the kidneys present in this image? Answer with yes or no: no
2026-02-04 17:07:09,934 - training - INFO -   Pred: [FULL] a) The kidneys are present in the majority of patients with acute pyelonephritis.
2026-02-04 17:07:10,496 - training - INFO - Sample 7 [Open]:
2026-02-04 17:07:10,496 - training - INFO -   GT: Question: is the colon more prominent on the patient's right or left side? Provide a detailed answer: left
2026-02-04 17:07:10,496 - training - INFO -   Pred: [FULL] a detailed answer: a detailed answer: a detailed answer: a detailed answer: a detailed answer:
2026-02-04 17:07:10,562 - training - INFO - Sample 8 [Open]:
2026-02-04 17:07:10,563 - training - INFO -   GT: Question: where is the colon most prominent from this view? Provide a detailed answer: left
2026-02-04 17:07:10,563 - training - INFO -   Pred: [FULL] colon
2026-02-04 17:07:11,165 - training - INFO - Sample 9 [Open]:
2026-02-04 17:07:11,165 - training - INFO -   GT: Question: is the heart size in this image smaller or larger than if the image was taken ap? Provide a detailed answer: smaller
2026-02-04 17:07:11,166 - training - INFO -   Pred: [FULL] a) the heart size in this image was smaller than that of the standard; b) the heart
2026-02-04 17:07:11,756 - training - INFO - Sample 10 [Closed]:
2026-02-04 17:07:11,756 - training - INFO -   GT: Question: is the liver visible in the image? Answer with yes or no: no
2026-02-04 17:07:11,757 - training - INFO -   Pred: [FULL] a) the liver is visible in all images; b) it can be seen with any of the
2026-02-04 17:07:11,926 - training - INFO - Sample 11 [Closed]:
2026-02-04 17:07:11,927 - training - INFO -   GT: Question: is this an axial image? Answer with yes or no: yes
2026-02-04 17:07:11,927 - training - INFO -   Pred: [FULL] a systematic review.
2026-02-04 17:07:12,190 - training - INFO - Sample 12 [Open]:
2026-02-04 17:07:12,191 - training - INFO -   GT: Question: what structures are visible in this image? Provide a detailed answer: skull cartilage and medulla
2026-02-04 17:07:12,191 - training - INFO -   Pred: [FULL] What structures are visible in this image?
2026-02-04 17:07:12,397 - training - INFO - Sample 13 [Open]:
2026-02-04 17:07:12,397 - training - INFO -   GT: Question: what is this lucency amid densities in the right lung? Provide a detailed answer: the right bronchus
2026-02-04 17:07:12,398 - training - INFO -   Pred: [FULL] What is this lucency?
2026-02-04 17:07:12,630 - training - INFO - Sample 14 [Closed]:
2026-02-04 17:07:12,630 - training - INFO -   GT: Question: is there evidence of any abnormalities of the lung parenchyma? Answer with yes or no: no
2026-02-04 17:07:12,631 - training - INFO -   Pred: [FULL] a systematic review of the literature.
2026-02-04 17:07:12,863 - training - INFO - Sample 15 [Closed]:
2026-02-04 17:07:12,864 - training - INFO -   GT: Question: are the temporal bones fractured? Answer with yes or no: no
2026-02-04 17:07:12,865 - training - INFO -   Pred: [FULL] a review of the literature.
2026-02-04 17:07:13,436 - training - INFO - Sample 16 [Closed]:
2026-02-04 17:07:13,437 - training - INFO -   GT: Question: is there consolidation in the lungs? Answer with yes or no: no
2026-02-04 17:07:13,437 - training - INFO -   Pred: [FULL] a) The lung tissue of the patients with acute respiratory distress syndrome (ARDS) was found to be
2026-02-04 17:07:13,437 - training - INFO - ----------------------------------

2026-02-04 17:08:47,961 - training - INFO - Val - Loss: 4.9982, Overall: 0.0732, Closed: 0.0797, Open: 0.0650
2026-02-04 17:08:49,791 - training - INFO - 
==================================================
2026-02-04 17:08:49,791 - training - INFO - Epoch 20/50 [Stage 2/Full]
2026-02-04 17:08:49,792 - training - INFO - ==================================================

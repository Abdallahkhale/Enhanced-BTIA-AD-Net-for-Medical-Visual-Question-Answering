2026-02-04 05:03:27,667 - training - INFO - Starting training with config: {'model': {'vision_encoder': 'microsoft/BiomedCLIP-PubMedBERT_256-vit_base_patch16_224', 'text_encoder': 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'type': 'generative', 'text_decoder': 'microsoft/BioGPT', 'freeze_vision': True, 'freeze_text': False, 'fusion_method': 'btia', 'use_answer_distillation': False, 'use_embedding_matching': False, 'pretraining_epochs': 10, 'use_lora': True, 'lora_r': 16, 'lora_alpha': 32}, 'training': {'batch_size': 16, 'learning_rate': 1e-05, 'weight_decay': 0.01, 'epochs': 50, 'warmup_ratio': 0.1, 'fp16': True, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'save_every_epoch': True, 'checkpoint_dir': 'checkpoints', 'resume_from': 'checkpoints/epoch_13.pt', 'early_stopping_patience': 10, 'early_stopping_metric': 'val_accuracy'}, 'data': {'image_size': 224, 'max_question_length': 64, 'max_answer_length': 32, 'use_slake_augmentation': False, 'use_pathvqa_augmentation': True, 'train_split': 0.8, 'num_workers': 4, 'vqa_rad_dir': 'data/vqa_rad', 'slake_dir': 'data/slake', 'pathvqa_dir': 'data/pathvqa'}, 'logging': {'log_dir': 'logs', 'log_every_n_steps': 10, 'use_tensorboard': True}}
2026-02-04 05:03:27,672 - training - INFO - Creating data loaders...
2026-02-04 05:03:37,178 - training - INFO - Creating model...
2026-02-04 05:03:45,780 - training - INFO - Model parameters: {'total': 419966016, 'trainable': 6293504, 'frozen': 413672512}
2026-02-04 05:03:45,781 - training - INFO - 
*** Two-Stage Training Enabled ***
2026-02-04 05:03:45,781 - training - INFO - Stage 1: 10 epochs training projection only (LLM frozen)
2026-02-04 05:03:45,782 - training - INFO - Stage 2: Remaining epochs training projection + LLM
2026-02-04 05:03:45,785 - training - INFO - After freezing LLM - Parameters: {'total': 419966016, 'trainable': 3147776, 'frozen': 416818240}
2026-02-04 05:03:45,788 - training - INFO - Resuming from checkpoint: checkpoints/epoch_13.pt
2026-02-04 05:03:46,675 - training - INFO - Resumed from epoch 12, best accuracy: 0.1530
2026-02-04 05:03:46,676 - training - INFO - Checkpoint is from Stage 2, setting up Stage 2 mode...
2026-02-04 05:03:46,680 - training - INFO - Stage 2 optimizer and scheduler recreated for epochs 13-50
2026-02-04 05:03:46,682 - training - INFO - Starting training...
2026-02-04 05:03:46,683 - training - INFO - 
==================================================
2026-02-04 05:03:46,685 - training - INFO - Epoch 14/50 [Stage 2/Full]
2026-02-04 05:03:46,686 - training - INFO - ==================================================
